<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords"
        content="Aly MBelleza, Bella Beauty, sal贸n de belleza, est茅tica profesional, peluquer铆a, tratamientos faciales, spa, belleza premium, cuidado del cabello, manicure, pedicure, masajes relajantes, productos de belleza, belleza natural, bienestar, servicios de belleza, maquillaje profesional, tratamientos capilares, depilaci贸n, rejuvenecimiento facial, asesor铆a de imagen, sal贸n de u帽as, belleza femenina, belleza masculina, reserva online belleza, promociones belleza, estilistas profesionales, corte de cabello, tintes, coloraci贸n, alisado de cabello, peinados para eventos, tratamientos corporales, belleza integral, centro de belleza, belleza en Quito, atenci贸n personalizada">
    <script src="https://cdn.tailwindcss.com"></script>
    <title>Bella Beauty - Experiencia de Belleza Premium</title>
    <link rel="stylesheet" href="/css/style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.js"></script>
    <link rel="icon" href="/img/mujer-con-pelo-largo.png" type="image/x-icon">
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
</head>

<body>

    <!-- Section Menu -->
    <header class="bg-white/95 backdrop-blur-lg sticky top-0 z-[1000] border-b border-purple-100 ">
        <div class="container mx-auto px-4 lg:px-8">
            <!-- Top Information Bar -->
            <div
                class="hidden md:flex justify-between items-center py-3 border-b border-purple-100 text-sm text-gray-600">
                <div class="flex items-center space-x-4">
                    <div class="flex items-center space-x-3">
                        <i class="fas fa-map-marker-alt text-purple-600"></i>
                        <a href="#" class="text-gray-700 hover:text-purple-700 transition duration-300">
                            Av. Principal 123, Ciudad
                        </a>
                    </div>
                    <div class="flex items-center space-x-3">
                        <i class="fas fa-envelope text-purple-600"></i>
                        <a href="mailto:info@bellabeauty.com"
                            class="text-gray-700 hover:text-purple-700 transition duration-300">
                            info@bellabeauty.com
                        </a>
                    </div>
                    <div class="flex items-center space-x-3">
                        <i class="fas fa-clock text-purple-600"></i>
                        <span class="text-gray-700">
                            Lun - Dom: 9:00 - 20:00
                        </span>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="relative flex items-center space-x-2 group">
                        <!-- Pantalla Completa -->
                        <button id="fullscreen-toggle"
                            class="text-purple-600 hover:text-purple-700 transition duration-300 p-2 rounded-full hover:bg-purple-50 focus:outline-none">
                            <i id="fullscreen-icon" class="fas fa-expand"></i>
                        </button>

                        <!-- Tooltip -->
                        <div
                            class="absolute top-full mt-2 left-1/2 transform -translate-x-1/2 px-4 py-2 text-white bg-purple-600 text-sm rounded-md opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap">
                            Activar pantalla completa
                        </div>
                    </div>

                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fas fa-search text-purple-400"></i>
                        </div>
                        <input type="search" placeholder="Buscar en el sitio..."
                            class="pl-10 pr-4 py-2 text-sm text-gray-900 border-none bg-purple-50 rounded-full focus:ring-2 focus:ring-purple-500 focus:outline-none transition duration-300" />
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="flex items-center space-x-3">
                        <!-- Icono de notificaciones minimalista -->
                        <div class="relative">
                            <button id="notification-btn"
                                class="text-purple-600 hover:text-purple-700 transition duration-200 p-2 rounded-full hover:bg-purple-50 relative"
                                title="Notificaciones">
                                <i class="fas fa-bell"></i>
                                <span id="notification-count"
                                    class="absolute -top-1 -right-1 bg-pink-600 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center font-bold hidden">0</span>
                            </button>

                            <!-- Dropdown minimalista -->
                            <div id="notification-dropdown"
                                class="absolute right-0 mt-2 w-80 bg-white rounded-xl shadow-lg z-50 border border-gray-100 overflow-hidden transition-all duration-200 origin-top-right transform opacity-0 scale-95 hidden">

                                <!-- Header con gradiente -->
                                <div
                                    class="px-5 py-4 bg-gradient-to-r from-blue-500 to-indigo-600 flex justify-between items-center">
                                    <div class="flex items-center gap-3">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none"
                                            viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
                                        </svg>
                                        <h4 class="font-semibold text-white text-lg">Notificaciones</h4>
                                    </div>
                                    <button onclick="closeNotifications()"
                                        class="text-blue-100 hover:text-white transition-colors">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none"
                                            viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M6 18L18 6M6 6l12 12" />
                                        </svg>
                                    </button>
                                </div>

                                <!-- Lista de notificaciones -->
                                <ul id="appointments-list" class="divide-y divide-gray-100 max-h-96 overflow-y-auto">
                                    <!-- Estado vac铆o -->
                                    <li class="empty-state hidden px-5 py-8 text-center">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto text-gray-300"
                                            fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                                d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                        </svg>
                                        <p class="mt-3 text-gray-500 font-medium">No hay notificaciones</p>
                                        <p class="text-sm text-gray-400 mt-1">Cuando tengas nuevas citas, aparecer谩n
                                            aqu铆</p>
                                    </li>

                                    <!-- Las notificaciones se insertar谩n aqu铆 -->
                                </ul>

                                <!-- Footer con acci贸n -->
                                <div class="px-4 py-3 bg-gray-50 border-t border-gray-100 text-right">
                                    <button
                                        class="text-sm font-medium text-blue-600 hover:text-blue-700 transition-colors flex items-center justify-end gap-1 w-full">
                                        <span>Marcar todas como le铆das</span>
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none"
                                            viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M5 13l4 4L19 7" />
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Resto de iconos -->
                        <a href="carrito.html"
                            class="text-purple-600 hover:text-purple-700 transition duration-200 p-2 rounded-full hover:bg-purple-50 relative"
                            title="Ver carrito">
                            <i class="fas fa-shopping-cart"></i>
                            <span id="cart-count"
                                class="absolute -top-1 -right-1 bg-pink-600 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center font-bold hidden">0</span>
                        </a>
                        <a href="https://www.tiktok.com/@merly_macias?lang=es" target="_blank"
                            class="text-purple-600 hover:text-purple-700 transition duration-200 p-2 rounded-full hover:bg-purple-50">
                            <i class="fab fa-tiktok"></i>
                        </a>
                        <a href="https://www.facebook.com/HairdresserandSpa?mibextid=LQQJ4d" target="_blank"
                            class="text-purple-600 hover:text-purple-700 transition duration-200 p-2 rounded-full hover:bg-purple-50">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="index3.html" id="reserva-btn"
                            class="text-sm text-white bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 transition duration-200 px-4 py-2 rounded-full shadow hover:shadow-md">
                            Reserva Online
                        </a>
                    </div>
                </div>

                <!-- Men煤 de usuario minimalista -->
                <div class="flex items-center relative">
                    <button type="button" class="flex rounded-full focus:outline-none" id="user-menu-button"
                        aria-expanded="false">
                        <span class="sr-only">Abrir men煤 de usuario</span>
                        <img id="profile-img" class="w-9 h-9 rounded-full border border-gray-200 object-cover" src=""
                            alt="Foto de perfil"
                            onerror="this.onerror=null;this.src='https://i.ibb.co/5WcsrDcY/mujer-con-pelo-largo.png';">
                    </button>

                    <!-- Dropdown menu minimalista y ancho -->
                    <div class="absolute top-full right-0 mt-2 w-80 origin-top-right transition-all duration-200 ease-out opacity-0 scale-95 translate-y-1 invisible"
                        id="user-dropdown">
                        <div class="z-50 bg-white rounded-md shadow-lg border border-gray-100">
                            <!-- Secci贸n de perfil amplia -->
                            <div class="px-5 py-4 border-b border-gray-100">
                                <div class="flex items-center space-x-4">
                                    <img id="dropdown-profile-img"
                                        class="w-12 h-12 rounded-full border border-gray-200 object-cover" src=""
                                        alt="Foto de perfil">
                                    <div class="min-w-0">
                                        <span id="profile-name"
                                            class="block text-base font-medium text-gray-900 truncate max-w-[220px]"></span>
                                        <span id="profile-email"
                                            class="block text-sm text-gray-500 truncate max-w-[220px]"></span>
                                    </div>
                                </div>
                            </div>

                            <!-- Opciones del men煤 simples -->
                            <ul class="py-1">
                                <li id="admin-link-container" class="hidden">
                                    <a href="admin-productos.html"
                                        class="block px-5 py-3 text-sm text-gray-700 hover:bg-gray-50">
                                        Panel Administrador
                                    </a>
                                </li>
                                <li id="profile-link-container" class="hidden">
                                    <a href="perfil.html"
                                        class="block px-5 py-3 text-sm text-gray-700 hover:bg-gray-50">
                                        Perfil
                                    </a>
                                </li>
                                <li>
                                    <button id="logout-btn"
                                        class="block w-full text-left px-5 py-3 text-sm text-red-600 hover: hover:bg-red-50 transition-colors duration-200">
                                        <div class="flex items-center">
                                            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor"
                                                viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                    d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1">
                                                </path>
                                            </svg>
                                            Cerrar sesi贸n
                                        </div>
                                    </button>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Botones de login/registro mejorados -->
                <div id="login-register-links" class="ml-6 hidden">
                    <div class="flex items-center space-x-4">
                        <a href="login.html"
                            class="text-sm font-medium text-purple-700 hover:text-purple-900 px-4 py-2 rounded-lg transition-colors duration-200 hover:bg-purple-50 border border-purple-200">
                            Iniciar sesi贸n
                        </a>
                        <a href="register.html"
                            class="text-sm font-medium text-white bg-gradient-to-r from-purple-600 to-indigo-600 px-4 py-2 rounded-lg shadow-sm hover:from-purple-700 hover:to-indigo-700 transition-all duration-300 transform hover:-translate-y-0.5">
                            Registrarse
                        </a>
                    </div>
                </div>
            </div>

            <!-- Main Navigation -->
            <div class="flex items-center justify-between py-4">
                <div class="flex items-center space-x-5">
                    <a href="index.html"
                        class="font-display text-3xl bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent">Bella
                        Beauty</a>
                    <p class="text-sm text-purple-600 hidden md:block">Tu belleza, nuestra pasi贸n</p>
                </div>

                <!-- Desktop Navigation -->
                <nav class="hidden md:flex items-center space-x-6 text-sm font-semibold text-gray-700">
                    <a href="index.html"
                        class="nav-link-hover px-3 py-2 rounded-md hover:text-purple-700 hover:bg-purple-50 transition duration-300">
                        Inicio
                    </a>
                    <div class="relative group">
                        <a href="#servicios"
                            class="nav-link-hover px-4 py-2 rounded-md hover:text-purple-700 hover:bg-purple-50 transition duration-300 flex items-center">
                            Servicios
                            <i class="fas fa-chevron-down ml-2 text-sm"></i>
                        </a>
                        <div
                            class="absolute left-0 mt-2 w-60 bg-white shadow-lg rounded-lg border border-purple-100 z-50 opacity-0 invisible group-hover:opacity-100 group-hover:visible transform group-hover:translate-y-2 transition-all duration-300">
                            <a href="#servicios"
                                class="block px-4 py-3 text-gray-700 hover:bg-purple-50 hover:text-purple-700 transition duration-300">
                                Tratamientos Faciales
                            </a>
                            <a href="#servicios"
                                class="block px-4 py-3 text-gray-700 hover:bg-purple-50 hover:text-purple-700 transition duration-300">
                                Manicure & Pedicure
                            </a>
                            <a href="#servicios"
                                class="block px-4 py-3 text-gray-700 hover:bg-purple-50 hover:text-purple-700 transition duration-300">
                                Masajes
                            </a>
                        </div>
                    </div>
                    <a href="productos.html"
                        class="nav-link-hover px-3 py-2 rounded-md hover:text-purple-700 hover:bg-purple-50 transition duration-300">
                        Productos
                    </a>
                    <a href="#contacto"
                        class="nav-link-hover px-3 py-2 rounded-md hover:text-purple-700 hover:bg-purple-50 transition duration-300">
                        Contacto
                    </a>
                    <a href="index2.html"
                        class="nav-link-hover px-3 py-2 rounded-md hover:text-purple-700 hover:bg-purple-50 transition duration-300">
                        Galeria
                    </a>
                </nav>

                <!-- Solo visible en m贸vil, oculto en escritorio -->
                <div class="flex items-center space-x-2 md:hidden">
                    <!-- Notificaciones -->
                    <button id="notification-btn"
                        class="text-purple-600 hover:text-purple-700 transition duration-200 p-2 rounded-full hover:bg-purple-50 relative"
                        title="Notificaciones">
                        <i class="fas fa-bell"></i>
                        <span id="notification-count"
                            class="absolute -top-1 -right-1 bg-pink-600 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center font-bold hidden">0</span>
                    </button>
                    <!-- Carrito -->
                    <a href="carrito.html"
                        class="text-purple-600 hover:text-purple-700 transition duration-200 p-2 rounded-full hover:bg-purple-50 relative"
                        title="Ver carrito">
                        <i class="fas fa-shopping-cart"></i>
                        <span id="cart-count"
                            class="absolute -top-1 -right-1 bg-pink-600 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center font-bold hidden">0</span>
                    </a>
                </div>
                <!-- Bot贸n men煤 m贸vil -->
                <button id="mobile-menu-toggle"
                    class="md:hidden text-purple-600 hover:text-purple-700 focus:outline-none">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                        <line x1="12" y1="18" x2="21" y2="18"></line>
                    </svg>
                </button>
            </div>
        </div>

        <!-- Mobile Menu -->
        <aside
            class="hidden fixed left-0 top-0 z-50 h-screen w-80 bg-white/95 backdrop-blur-md rounded-r-3xl border-r border-purple-100 shadow-lg overflow-y-auto"
            id="mobile-menu">
            <!-- Header -->
            <div class="p-4 mb-6 border-b border-purple-100">
                <div class="flex items-center mb-3">
                    <div class="ml-3">
                        <h2
                            class="text-xl font-display bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent">
                            Bella Beauty
                        </h2>
                        <p class="text-sm text-purple-600">Tu belleza, nuestra pasi贸n</p>
                    </div>
                </div>
            </div>

            <!-- Secci贸n de Perfil (solo visible con sesi贸n) -->
            <div id="mobile-user-profile-section" class="hidden px-4 py-4 mb-4 border-b border-purple-100">
                <div class="flex items-center space-x-4">
                    <!-- Foto de perfil con indicador de estado -->
                    <div class="relative">
                        <img id="mobile-profile-img"
                            class="w-14 h-14 rounded-full border-2 border-purple-100 object-cover shadow-sm" src=""
                            alt="Foto de perfil"
                            onerror="this.onerror=null;this.src='https://i.ibb.co/5WcsrDcY/mujer-con-pelo-largo.png';">
                        <span id="mobile-status-indicator"
                            class="absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white"></span>
                    </div>

                    <!-- Informaci贸n del usuario -->
                    <div class="flex-1 min-w-0">
                        <div class="flex items-center justify-between">
                            <span id="mobile-profile-name"
                                class="block text-base font-semibold text-gray-900 truncate max-w-[140px]"></span>
                            <button id="mobile-logout-btn" class="text-red-500 hover:text-red-700 transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24"
                                    stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                                </svg>
                            </button>
                        </div>
                        <span id="mobile-profile-email"
                            class="block text-sm text-gray-600 truncate max-w-[160px]"></span>
                        <span id="mobile-profile-role"
                            class="inline-block mt-1 px-2 py-0.5 text-xs font-semibold rounded-full bg-purple-100 text-purple-800"></span>
                    </div>
                </div>

                <!-- Enlace admin (solo visible para administradores) -->
                <div id="mobile-admin-link-container" class="mt-3 hidden">
                    <a href="admin-productos.html"
                        class="inline-flex items-center text-sm text-purple-700 hover:text-purple-900 font-medium">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                        </svg>
                        Panel Administrador
                    </a>
                </div>
                <!-- Enlace perfil (solo visible con sesi贸n) -->
                <div id="mobile-profile-link-container" class="mt-3 hidden">
                    <a href="perfil.html"
                        class="inline-flex items-center text-sm text-gray-700 hover:text-purple-700 font-medium">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M5.121 17.804A9 9 0 1112 21a9 9 0 01-6.879-3.196z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                        </svg>
                        Perfil
                    </a>
                </div>
            </div>

            <!-- Botones de Login/Registro (solo visible sin sesi贸n) -->
            <div id="mobile-login-section" class="px-4 py-4 mb-4 border-b border-purple-100">
                <div class="space-y-3">
                    <a href="login.html"
                        class="block w-full text-center py-2.5 text-sm font-medium text-purple-700 border border-purple-300 rounded-lg hover:bg-purple-50 transition-colors duration-200">
                        Iniciar sesi贸n
                    </a>
                    <a href="register.html"
                        class="block w-full text-center py-2.5 text-sm font-medium text-white bg-gradient-to-r from-purple-600 to-pink-600 rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all duration-300 shadow-sm">
                        Registrarse
                    </a>
                </div>
            </div>

            <!-- Top Information Section -->
            <div class="px-4 mb-6 space-y-4 border-b border-purple-100 pb-4">
                <div class="flex items-center space-x-3">
                    <i class="fas fa-map-marker-alt text-purple-600"></i>
                    <a href="#" class="text-sm text-gray-700 hover:text-purple-700 transition duration-300">
                        Av. Principal 123, Ciudad
                    </a>
                </div>
                <div class="flex items-center space-x-3">
                    <i class="fas fa-envelope text-purple-600"></i>
                    <a href="mailto:info@bellabeauty.com"
                        class="text-sm text-gray-700 hover:text-purple-700 transition duration-300">
                        info@bellabeauty.com
                    </a>
                </div>
                <div class="flex items-center space-x-3">
                    <i class="fas fa-clock text-purple-600"></i>
                    <span class="text-sm text-gray-700">
                        Lun - Dom: 9:00 - 20:00
                    </span>
                </div>
            </div>

            <!-- Search Bar -->
            <div class="px-4 mb-6">
                <div class="relative">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <i class="fas fa-search text-purple-400"></i>
                    </div>
                    <input type="search" placeholder="Buscar en el sitio..."
                        class="w-full pl-10 pr-4 py-2 text-sm text-gray-900 border-none bg-purple-50 rounded-full focus:ring-2 focus:ring-purple-500 focus:outline-none transition duration-300" />
                </div>
            </div>

            <!-- Main Navigation -->
            <div class="mb-6">
                <ul class="space-y-1">
                    <li>
                        <a href="index.html"
                            class="flex items-center px-4 py-2 text-sm font-medium text-gray-900 hover:bg-purple-50">
                            <i class="fas fa-home w-5 h-5 text-purple-500 mr-3"></i>
                            Inicio
                        </a>
                    </li>
                    <!-- Servicios with Dropdown -->
                    <li class="relative">
                        <button onclick="toggleServicesMenu()"
                            class="flex items-center justify-between w-full px-4 py-2 text-sm font-medium text-gray-900 hover:bg-purple-50">
                            <div class="flex items-center">
                                <i class="fas fa-spa w-5 h-5 text-purple-500 mr-3"></i>
                                Servicios
                            </div>
                            <i class="fas fa-chevron-down text-sm"></i>
                        </button>
                        <ul id="services-submenu" class="hidden pl-12 py-2 space-y-1">
                            <li>
                                <a href="#servicios" class="block py-2 text-sm text-gray-700 hover:text-purple-700">
                                    Tratamientos Faciales
                                </a>
                            </li>
                            <li>
                                <a href="#servicios" class="block py-2 text-sm text-gray-700 hover:text-purple-700">
                                    Manicure & Pedicure
                                </a>
                            </li>
                            <li>
                                <a href="#servicios" class="block py-2 text-sm text-gray-700 hover:text-purple-700">
                                    Masajes
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="productos.html"
                            class="flex items-center px-4 py-2 text-sm font-medium text-gray-900 hover:bg-purple-50">
                            <i class="fas fa-shopping-bag w-5 h-5 text-purple-500 mr-3"></i>
                            Productos
                        </a>
                    </li>
                    <li>
                        <a href="#contacto"
                            class="flex items-center px-4 py-2 text-sm font-medium text-gray-900 hover:bg-purple-50">
                            <i class="fas fa-envelope w-5 h-5 text-purple-500 mr-3"></i>
                            Contacto
                        </a>
                    </li>
                    <li>
                        <a href="index2.html"
                            class="flex items-center px-4 py-2 text-sm font-medium text-gray-900 hover:bg-purple-50">
                            <i class="fas fa-images w-5 h-5 text-purple-500 mr-3"></i>
                            Galeria
                        </a>
                    </li>
                </ul>
            </div>

            <!-- Social Links and Reservation -->
            <div class="px-4 space-y-4 mb-6">
                <!-- Social Media Links -->
                <div class="flex items-center justify-center space-x-4">
                    <a href="https://www.tiktok.com/@merly_macias?lang=es" target="_blank"
                        class="text-purple-600 hover:text-purple-700 transition duration-300 p-2 rounded-full hover:bg-purple-50">
                        <i class="fab fa-tiktok"></i>
                    </a>
                    <a href="https://www.facebook.com/HairdresserandSpa?mibextid=LQQJ4d" target="_blank"
                        class="text-purple-600 hover:text-purple-700 transition duration-300 p-2 rounded-full hover:bg-purple-50">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                </div>
                <!-- Reservation Button -->
                <a href="index3.html" id="reserva-btn"
                    class="block w-full text-center py-3 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white rounded-full transition duration-300 shadow-md hover:shadow-lg">
                    Reserva Online
                </a>
            </div>

            <!-- Fullscreen Toggle -->
            <div class="px-4">
                <button id="mobile-fullscreen-toggle"
                    class="flex items-center space-x-2 w-full px-4 py-2 text-sm font-medium text-gray-900 hover:bg-purple-50 rounded-lg">
                    <i class="fas fa-expand w-5 h-5 text-purple-500"></i>
                    <span>Pantalla Completa</span>
                </button>
            </div>
        </aside>
    </header>



    <script>
        //Script para el men煤 del celular
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById("mobile-menu");
            const menuIcon = document
                .getElementById("mobile-menu-toggle")
                .querySelector("svg");
            mobileMenu.classList.toggle("hidden");
            if (!mobileMenu.classList.contains("hidden")) {
                menuIcon.innerHTML = `
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                `;
            } else {
                menuIcon.innerHTML = `
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"/>
                `;
            }
        }
        document.addEventListener("DOMContentLoaded", () => {
            const mobileMenuToggle = document.getElementById("mobile-menu-toggle");
            if (mobileMenuToggle) {
                mobileMenuToggle.addEventListener("click", toggleMobileMenu);
            }
        });
    </script>
    <!-- Script para el env铆o del Correo -->
    <script>
        document.getElementById('contactForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const form = e.target;
            const submitBtn = form.querySelector('button[type="submit"]');
            const originalBtnText = submitBtn.innerHTML;

            // Mostrar estado de carga
            submitBtn.disabled = true;
            submitBtn.innerHTML = `
                <span class="flex items-center justify-center">
                    <svg class="animate-spin -ml-1 mr-2 h-4 w-4 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    Enviando...
                </span>
            `;

            try {
                const formData = {
                    name: form.name.value,
                    email: form.email.value,
                    message: form.message.value
                };

                const response = await fetch('https://aly-mbelleza-backend.onrender.com/api/send-email', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });

                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.error || 'Error al enviar el mensaje');
                }

                // Mostrar notificaci贸n de 茅xito usando tu funci贸n
                showNotification(
                    'success',
                    'Mensaje enviado',
                    'Tu mensaje ha sido enviado correctamente'
                );
                form.reset();

            } catch (error) {
                // Mostrar notificaci贸n de error usando tu funci贸n
                showNotification(
                    'error',
                    'Error al enviar',
                    error.message || 'Ocurri贸 un error al enviar el mensaje'
                );

            } finally {
                // Restaurar el bot贸n
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalBtnText;
            }
        });
    </script>

    <!-- Script para la funcionalidad del bot贸n de Usuario y Reservas en l铆nea -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const user = JSON.parse(localStorage.getItem('user'));
            const profileLinkContainer = document.getElementById('profile-link-container');
            const profileImg = document.getElementById('profile-img');
            const dropdownProfileImg = document.getElementById('dropdown-profile-img');
            const profileName = document.getElementById('profile-name');
            const profileEmail = document.getElementById('profile-email');
            const logoutBtn = document.getElementById('logout-btn');
            const userMenuBtn = document.getElementById('user-menu-button');
            const userDropdown = document.getElementById('user-dropdown');
            const adminLinkContainer = document.getElementById('admin-link-container');
            const loginRegisterLinks = document.getElementById('login-register-links');

            // --- L贸gica para el bot贸n de Reserva Online ---
            const reservaBtn = document.getElementById('reserva-btn');
            // Selecciona el bot贸n de reserva en el men煤 m贸vil por el texto y href
            const mobileReservaBtn = Array.from(document.querySelectorAll('aside a')).find(
                a => a.href && a.href.includes('index3.html') && a.textContent.trim().toLowerCase().includes('reserva online')
            );

            if (reservaBtn) {
                if (!user) {
                    reservaBtn.classList.add('opacity-50', 'pointer-events-none', 'cursor-not-allowed');
                    reservaBtn.setAttribute('title', 'Debes iniciar sesi贸n para reservar');
                    reservaBtn.href = "login.html";
                    reservaBtn.addEventListener('click', function (e) {
                        e.preventDefault();
                        window.location.href = "login.html";
                    });
                } else {
                    reservaBtn.classList.remove('opacity-50', 'pointer-events-none', 'cursor-not-allowed');
                    reservaBtn.removeAttribute('title');
                    reservaBtn.href = "index3.html";
                }
            }
            if (mobileReservaBtn) {
                if (!user) {
                    mobileReservaBtn.classList.add('opacity-50', 'pointer-events-none', 'cursor-not-allowed');
                    mobileReservaBtn.setAttribute('title', 'Debes iniciar sesi贸n para reservar');
                    mobileReservaBtn.href = "login.html";
                    mobileReservaBtn.addEventListener('click', function (e) {
                        e.preventDefault();
                        window.location.href = "login.html";
                    });
                } else {
                    mobileReservaBtn.classList.remove('opacity-50', 'pointer-events-none', 'cursor-not-allowed');
                    mobileReservaBtn.removeAttribute('title');
                    mobileReservaBtn.href = "index3.html";
                }
            }
            // --- Fin l贸gica Reserva Online ---

            // Funci贸n para abrir/cerrar el dropdown
            const toggleDropdown = (open) => {
                if (open) {
                    userDropdown.classList.remove('opacity-0', 'scale-95', 'translate-y-1', 'invisible');
                    userDropdown.classList.add('opacity-100', 'scale-100', 'translate-y-0', 'visible');
                    userMenuBtn.setAttribute('aria-expanded', 'true');
                } else {
                    userDropdown.classList.remove('opacity-100', 'scale-100', 'translate-y-0', 'visible');
                    userDropdown.classList.add('opacity-0', 'scale-95', 'translate-y-1', 'invisible');
                    userMenuBtn.setAttribute('aria-expanded', 'false');
                }
            };

            if (user) {
                // Mostrar datos del usuario
                profileLinkContainer.classList.remove('hidden');
                profileName.textContent = user.name || 'Usuario';
                profileEmail.textContent = user.email || '';

                // Mostrar opci贸n admin si corresponde
                if (user.role === 'admin') {
                    adminLinkContainer.classList.remove('hidden');
                }

                // Imagen de perfil
                const profileImageUrl = user.profileImage && user.profileImage.startsWith('http') ? user.profileImage :
                    user.profileImage && user.profileImage.startsWith('/uploads/') ?
                        'https://aly-mbelleza-backend.onrender.com' + user.profileImage :
                        `https://ui-avatars.com/api/?name=${encodeURIComponent(user.name || 'U')}&background=random&length=1`;

                profileImg.src = profileImageUrl;
                dropdownProfileImg.src = profileImageUrl;

                // Evento para el bot贸n de usuario
                userMenuBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const isExpanded = userMenuBtn.getAttribute('aria-expanded') === 'true';
                    toggleDropdown(!isExpanded);
                });

                // Cerrar dropdown al hacer click fuera
                document.addEventListener('click', (e) => {
                    if (!userMenuBtn.contains(e.target) && !userDropdown.contains(e.target)) {
                        toggleDropdown(false);
                    }
                });

                // Logout con SweetAlert
                logoutBtn.addEventListener('click', () => {
                    Swal.fire({
                        title: '驴Cerrar sesi贸n?',
                        text: '驴Est谩s seguro de que deseas salir de tu cuenta?',
                        icon: 'question',
                        showCancelButton: true,
                        confirmButtonColor: '#7e22ce',
                        cancelButtonColor: '#6b7280',
                        confirmButtonText: 'S铆, cerrar sesi贸n',
                        cancelButtonText: 'Cancelar',
                        backdrop: ``,
                        customClass: {
                            popup: 'border border-purple-200 rounded-lg shadow-lg',
                            confirmButton: 'bg-purple-600 hover:bg-purple-700 focus:ring-4 focus:ring-purple-300',
                            cancelButton: 'bg-gray-500 hover:bg-gray-600 focus:ring-4 focus:ring-gray-300'
                        }
                    }).then((result) => {
                        if (result.isConfirmed) {
                            localStorage.removeItem('user');
                            Swal.fire({
                                title: 'Sesi贸n cerrada',
                                text: 'Has cerrado sesi贸n correctamente',
                                icon: 'success',
                                confirmButtonColor: '#7e22ce',
                                timer: 1500,
                                timerProgressBar: true
                            }).then(() => {
                                window.location.href = 'index.html';
                            });
                        }
                    });
                });
            } else {
                // Mostrar opciones de login/registro
                profileLinkContainer.classList.add('hidden');
                loginRegisterLinks.classList.remove('hidden');
                userMenuBtn.parentElement.style.display = 'none';
            }
        });
    </script>

    <!-- Script para la reserva en linea -->
    <script>
        const NOTIFICATION_API_URL = "https://aly-mbelleza-backend.onrender.com/api/appointments";

        // Funci贸n para guardar la cita y abrir WhatsApp
        async function handleDateClick(date) {
            const user = JSON.parse(localStorage.getItem('user'));
            if (!user || !user.token) {
                Swal.fire('Debes iniciar sesi贸n para agendar una cita');
                return;
            }

            // Resaltar d铆a seleccionado
            const allCells = document.querySelectorAll('#calendar > div');
            allCells.forEach(cell => {
                cell.classList.remove('bg-blue-600', 'text-white');
                if (cell.textContent && isToday(new Date(currentDate.getFullYear(), currentDate.getMonth(), parseInt(cell.textContent)))) {
                    cell.classList.add('bg-blue-100');
                }
            });

            // Guardar cita en backend
            try {
                const res = await fetch(NOTIFICATION_API_URL, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "Authorization": `Bearer ${user.token}`
                    },
                    body: JSON.stringify({ date })
                });
                const data = await res.json();
                if (data.success) {
                    Swal.fire('隆Cita agendada!', 'Tu cita ha sido registrada.', 'success');
                    loadAppointments(); // Actualiza el panel y notificaciones
                } else {
                    Swal.fire('Error', data.message || 'No se pudo agendar la cita', 'error');
                }
            } catch (err) {
                Swal.fire('Error', 'No se pudo conectar con el servidor', 'error');
            }

            // WhatsApp
            const formattedDate = date.toLocaleDateString('es-ES', {
                weekday: 'long',
                day: 'numeric',
                month: 'long',
                year: 'numeric'
            });
            const message = `Hola Merly , quiero agendar una cita para el ${formattedDate}, me confirmas si estar谩s disponible, gracias amiga わ, espero tu respuesta.`;
            const phoneNumber = '593981229675';
            const whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
        }

        // Cargar citas del usuario y mostrarlas en el panel y notificaciones
        async function loadAppointments() {
            const user = JSON.parse(localStorage.getItem('user'));
            if (!user || !user.token) return;
            try {
                const res = await fetch(NOTIFICATION_API_URL, {
                    headers: { "Authorization": `Bearer ${user.token}` }
                });
                const data = await res.json();
                console.log("CITAS QUE LLEGAN DEL BACKEND:", data);
                if (data.success) {
                    renderAppointments(data.appointments);
                    renderNotifications(data.appointments);
                }
            } catch (err) {
                // Puedes mostrar un error si quieres
            }
        }

        // Renderizar citas en el panel
        function renderAppointments(appointments) {
            const list = document.getElementById('appointments-list');
            list.innerHTML = '';
            if (!appointments.length) {
                list.innerHTML = '<li class="text-gray-500">No tienes citas pendientes.</li>';
                return;
            }
            appointments.forEach(app => {
                const li = document.createElement('li');
                li.className = "flex justify-between items-center bg-purple-50 rounded-lg px-4 py-2";
                li.innerHTML = `
                    <div class="flex items-center justify-between bg-gray-50 p-3 rounded-lg border border-gray-200">
                        <div class="flex items-center gap-3">
                            <div class="bg-blue-100 p-2 rounded-full">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                            </svg>
                            </div>
                            <span class="font-medium text-gray-700">
                            ${new Date(app.date).toLocaleDateString('es-ES', { weekday: 'short', day: 'numeric', month: 'short', year: 'numeric' })}
                            </span>
                        </div>
                        
                        <div class="flex gap-2">
                            <button class="realizada-btn px-3 py-1.5 bg-emerald-500 hover:bg-emerald-600 text-white rounded-md text-sm font-medium flex items-center gap-1 transition-colors" data-id="${app._id}">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                            </svg>
                            Realizada
                            </button>
                            <button class="cancelar-btn px-3 py-1.5 bg-rose-500 hover:bg-rose-600 text-white rounded-md text-sm font-medium flex items-center gap-1 transition-colors" data-id="${app._id}">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                            </svg>
                            Cancelar
                            </button>
                        </div>
                    </div>
                `;
                list.appendChild(li);
            });

            // Eventos para los botones
            document.querySelectorAll('.realizada-btn').forEach(btn => {
                btn.onclick = () => updateAppointmentStatus(btn.dataset.id, 'realizada');
            });
            document.querySelectorAll('.cancelar-btn').forEach(btn => {
                btn.onclick = () => cancelAppointment(btn.dataset.id);
            });
        }

        // Renderizar notificaciones
        function renderNotifications(appointments) {
            const count = document.getElementById('notification-count');
            const list = document.getElementById('appointments-list');
            count.textContent = appointments.length;
            if (appointments.length > 0) {
                count.classList.remove('hidden');
            } else {
                count.classList.add('hidden');
            }
            list.innerHTML = '';
            if (!appointments.length) {
                list.innerHTML = `
                    <li class="px-5 py-8 text-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto text-gray-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <p class="mt-3 text-gray-500 font-medium">No hay notificaciones</p>
                        <p class="text-sm text-gray-400 mt-1">Cuando tengas nuevas citas, aparecer谩n aqu铆</p>
                    </li>
                `;
                return;
            }
            appointments.forEach(app => {
                // Estado visual
                let estado = app.status || 'pendiente';
                let estadoColor = 'text-yellow-500';
                let estadoIcon = `<i class="fas fa-clock"></i>`;
                let estadoText = 'Pendiente';
                if (estado === 'realizada') {
                    estadoColor = 'text-emerald-500';
                    estadoIcon = `<i class="fas fa-check-circle"></i>`;
                    estadoText = 'Realizada';
                } else if (estado === 'cancelada') {
                    estadoColor = 'text-rose-500';
                    estadoIcon = `<i class="fas fa-times-circle"></i>`;
                    estadoText = 'Cancelada';
                }
                // Fecha y hora
                const fecha = new Date(app.date);
                const fechaStr = fecha.toLocaleDateString('es-ES', { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' });
                const horaStr = fecha.toLocaleTimeString('es-ES', { hour: '2-digit', minute: '2-digit' });

                // Mensaje
                const mensaje = `Tienes una reservaci贸n con tu estilista el <span class="font-semibold">${fechaStr}`;

                // Botones solo si est谩 pendiente
                let botones = '';
                if (estado === 'pendiente') {
                    botones = `
                        <div class="flex gap-2 mt-3">
                            <button class="cancelar-btn px-3 py-1.5 bg-rose-500 hover:bg-rose-600 text-white rounded-md text-xs font-medium flex items-center gap-1 transition-colors" data-id="${app._id}">
                                <i class="fas fa-times"></i> Cancelar
                            </button>
                            <button class="realizada-btn px-3 py-1.5 bg-emerald-500 hover:bg-emerald-600 text-white rounded-md text-xs font-medium flex items-center gap-1 transition-colors" data-id="${app._id}">
                                <i class="fas fa-check"></i> Realizada
                            </button>
                        </div>
                    `;
                }

                const li = document.createElement('li');
                li.className = "px-5 py-4 flex flex-col gap-1 bg-white hover:bg-purple-50 rounded-xl mb-2 shadow-sm border border-gray-100";
                li.innerHTML = `
                    <div class="flex items-center gap-3">
                        <span class="text-xl ${estadoColor}">${estadoIcon}</span>
                        <span class="text-sm font-semibold ${estadoColor}">${estadoText}</span>
                    </div>
                    <div class="text-gray-700 text-sm mt-1">${mensaje}</div>
                    ${botones}
                `;
                list.appendChild(li);
            });

            // Eventos para los botones
            document.querySelectorAll('.realizada-btn').forEach(btn => {
                btn.onclick = () => updateAppointmentStatus(btn.dataset.id, 'realizada');
            });
            document.querySelectorAll('.cancelar-btn').forEach(btn => {
                btn.onclick = () => cancelAppointment(btn.dataset.id);
            });
        }

        // Cambiar estado de cita
        async function updateAppointmentStatus(id, status) {
            const user = JSON.parse(localStorage.getItem('user'));
            if (!user || !user.token) return;
            // Actualiza en la base de datos
            await fetch(`${NOTIFICATION_API_URL}/${id}`, {
                method: "PATCH",
                headers: {
                    "Content-Type": "application/json",
                    "Authorization": `Bearer ${user.token}`
                },
                body: JSON.stringify({ status })
            });
            // Quita la notificaci贸n del DOM
            const li = document.querySelector(`.realizada-btn[data-id="${id}"]`)?.closest('li') ||
                document.querySelector(`.cancelar-btn[data-id="${id}"]`)?.closest('li');
            if (li) li.remove();
            // Actualiza el contador
            const count = document.getElementById('notification-count');
            const list = document.getElementById('appointments-list');
            count.textContent = list.children.length;
            if (list.children.length === 0) {
                list.innerHTML = '<li class="text-gray-500 px-4 py-2">Sin notificaciones.</li>';
                count.classList.add('hidden');
            }
        }

        // Cancelar cita y abrir WhatsApp
        async function cancelAppointment(id) {
            const user = JSON.parse(localStorage.getItem('user'));
            if (!user || !user.token) return;
            // Buscar la cita para obtener la fecha
            const res = await fetch(NOTIFICATION_API_URL, { headers: { "Authorization": `Bearer ${user.token}` } });
            const data = await res.json();
            const cita = data.appointments.find(a => a._id === id);
            if (cita) {
                const formattedDate = new Date(cita.date).toLocaleDateString('es-ES', {
                    weekday: 'long', day: 'numeric', month: 'long', year: 'numeric'
                });
                const message = `Hola Merly, lamentablemente debo cancelar mi cita para el ${formattedDate}. Disculpa las molestias.`;
                const phoneNumber = '593981229675';
                const whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
                window.open(whatsappUrl, '_blank');
            }
            // Cambiar estado en backend
            await updateAppointmentStatus(id, 'cancelada');
        }

        // Cargar citas al iniciar
        document.addEventListener('DOMContentLoaded', loadAppointments);

    </script>

    <!-- Script para centro de notificaciones -->
    <script>
        document.getElementById('notification-btn').onclick = function (e) {
            e.stopPropagation();
            const dropdown = document.getElementById('notification-dropdown');
            const isHidden = dropdown.classList.contains('hidden');
            if (isHidden) {
                dropdown.classList.remove('hidden', 'opacity-0', 'scale-95');
                dropdown.classList.add('opacity-100', 'scale-100');
            } else {
                dropdown.classList.remove('opacity-100', 'scale-100');
                dropdown.classList.add('opacity-0', 'scale-95');
                setTimeout(() => dropdown.classList.add('hidden'), 200);
            }
            if (!dropdown.classList.contains('hidden')) {
                loadAppointments();
            }
        };

        function closeNotifications() {
            const dropdown = document.getElementById('notification-dropdown');
            dropdown.classList.remove('opacity-100', 'scale-100');
            dropdown.classList.add('opacity-0', 'scale-95');
            setTimeout(() => dropdown.classList.add('hidden'), 200);
        }

        document.addEventListener('click', function (event) {
            const dropdown = document.getElementById('notification-dropdown');
            const btn = document.getElementById('notification-btn');
            if (!dropdown.contains(event.target) && !btn.contains(event.target)) {
                dropdown.classList.remove('opacity-100', 'scale-100');
                dropdown.classList.add('opacity-0', 'scale-95');
                setTimeout(() => dropdown.classList.add('hidden'), 200);
            }
        });
    </script>

    <!-- Script para agregar al carrito -->
    <script>
        async function actualizarContadorCarrito() {
            const user = JSON.parse(localStorage.getItem('user'));
            if (!user || !user.token) return;
            try {
                const res = await fetch("https://aly-mbelleza-backend.onrender.com/api/cart", {
                    headers: { "Authorization": `Bearer ${user.token}` }
                });
                const data = await res.json();
                const count = data?.cart?.items?.length || 0;
                const cartCount = document.getElementById('cart-count');
                if (cartCount) {
                    cartCount.textContent = count;
                    if (count > 0) {
                        cartCount.classList.remove('hidden');
                    } else {
                        cartCount.classList.add('hidden');
                    }
                }
            } catch (err) {
                // Si hay error, oculta el contador
                const cartCount = document.getElementById('cart-count');
                if (cartCount) cartCount.classList.add('hidden');
            }
        }

        async function addToCart(token, productId, cantidad) {
            const res = await fetch("https://aly-mbelleza-backend.onrender.com/api/cart/add", {
                method: "POST",
                headers: {
                    "Authorization": `Bearer ${token}`,
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({ productId, cantidad })
            });
            const data = await res.json().catch(() => ({}));
            if (!res.ok) {
                console.error('Error al agregar al carrito:', data);
                throw new Error(data.message || data.error || "No se pudo agregar al carrito");
            }
            return data;
        }

        document.addEventListener("DOMContentLoaded", async () => {
            const contenedor = document.getElementById("productos-lista");
            if (!contenedor) return;
            try {
                const res = await fetch("https://aly-mbelleza-backend.onrender.com/api/products");
                const { data } = await res.json();

                contenedor.innerHTML = data.slice(0, 8).map((p) => {
                    let imageUrl = p.image || "./img/default.jpg";
                    return `
                        <div class="xl:w-1/4 md:w-1/2 p-4">
                            <div class="bg-white rounded-xl shadow-md overflow-hidden transition-all duration-300 hover:shadow-lg hover:-translate-y-1 border border-gray-100">
                                <div class="relative">
                                    <img class="h-48 w-full object-cover object-center" src="${imageUrl}" alt="${p.name}">
                                    <div class="absolute top-4 left-4">
                                        <span class="${p.featured ? 'bg-blue-500' : 'bg-gray-500'} text-white px-3 py-1 rounded-full text-xs font-semibold tracking-wide">
                                            ${p.featured ? 'DESTACADO' : (p.category === 'capilar' ? 'CAPILAR' : 'FACIAL')}
                                        </span>
                                    </div>
                                </div>
                                <div class="p-5">
                                    <h3 class="text-blue-600 text-xs font-medium tracking-wider uppercase mb-1">
                                        ${p.category === 'capilar' ? 'Productos Capilares' : 'Productos Faciales'}
                                    </h3>
                                    <h2 class="text-lg font-bold text-gray-900 mb-2 line-clamp-2 hover:text-blue-600 transition-colors duration-200">
                                        ${p.name}
                                    </h2>
                                    <p class="text-gray-500 text-sm mb-4 line-clamp-2">
                                        ${p.description}
                                    </p>
                                    <div class="flex items-center justify-between mb-3">
                                        <div class="flex items-center space-x-1">
                                            <svg class="w-4 h-4 text-yellow-400" fill="currentColor" viewBox="0 0 20 20">
                                                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                                            </svg>
                                            <span class="text-gray-600 text-sm">${p.rating || 'N/A'}</span>
                                        </div>
                                        <span class="text-xs ${p.availability ? 'text-green-600' : 'text-red-500'} font-medium">
                                            ${p.availability ? 'Disponible' : 'Agotado'}
                                        </span>
                                    </div>
                                    <div class="flex items-center justify-between pt-3 border-t border-gray-100">
                                        <div>
                                            <span class="text-gray-900 font-bold text-lg">$${p.price}</span>
                                            ${p.originalPrice ? `<span class="text-gray-400 text-sm line-through ml-2">$${p.originalPrice}</span>` : ''}
                                        </div>
                                        ${p.availability ? `
                                            <button 
                                                class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 flex items-center agregar-carrito-btn"
                                                data-producto='${JSON.stringify(p)}'>
                                                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"></path>
                                                </svg>
                                                Agregar al carrito
                                            </button>
                                        ` : `
                                            <button class="bg-gray-300 text-gray-500 px-4 py-2 rounded-lg text-sm font-medium cursor-not-allowed" disabled>
                                                Agotado
                                            </button>
                                        `}
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                }).join("");

                // Evento para agregar al carrito
                document.querySelectorAll('.agregar-carrito-btn').forEach(btn => {
                    btn.addEventListener('click', async function (e) {
                        const user = JSON.parse(localStorage.getItem('user'));
                        if (!user || !user.token) {
                            window.location.href = 'login.html';
                            return;
                        }
                        const producto = JSON.parse(btn.getAttribute('data-producto'));
                        try {
                            await addToCart(user.token, producto._id, 1);
                            Swal.fire({
                                icon: 'success',
                                title: '隆Agregado!',
                                text: 'Producto agregado al carrito',
                                timer: 1200,
                                showConfirmButton: false
                            });
                            // Actualiza el contador del carrito aqu铆
                            actualizarContadorCarrito();
                        } catch (err) {
                            Swal.fire('Error', err.message || 'No se pudo agregar al carrito', 'error');
                        }
                    });
                });

                // Al cargar la p谩gina, actualiza el contador si hay usuario
                actualizarContadorCarrito();

            } catch (err) {
                contenedor.innerHTML = `<div class="w-full text-center text-red-500 py-8">No se pudieron cargar los productos.</div>`;
            }
        });
    </script>

    <!-- Script global para actualizar el contador del carrito en todas las p谩ginas -->
    <script>
        window.actualizarContadorCarrito = async function () {
            const user = JSON.parse(localStorage.getItem('user'));
            const cartCount = document.getElementById('cart-count');
            if (!cartCount) return;
            if (!user || !user.token) {
                cartCount.textContent = "0";
                cartCount.classList.add('hidden');
                return;
            }
            try {
                const res = await fetch("https://aly-mbelleza-backend.onrender.com/api/cart", {
                    headers: { "Authorization": `Bearer ${user.token}` }
                });
                const data = await res.json();
                // Soporta varias estructuras de respuesta
                const items = data?.cart?.items || data?.items || data?.cart || [];
                const count = Array.isArray(items) ? items.reduce((acc, item) => acc + (item.cantidad || 1), 0) : 0;
                cartCount.textContent = count;
                if (count > 0) {
                    cartCount.classList.remove('hidden');
                } else {
                    cartCount.classList.add('hidden');
                }
            } catch (err) {
                cartCount.textContent = "0";
                cartCount.classList.add('hidden');
            }
        };

        // Llama a la funci贸n al cargar la p谩gina
        document.addEventListener("DOMContentLoaded", () => {
            if (document.getElementById('cart-count')) {
                window.actualizarContadorCarrito();
            }
        });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <script src="js/main.js"></script>
</body>

</html>